import{_ as ye,l as ke,g as Ve,a as d,r as he,n as be,f as n,E as ge,o as p,c as xe,b as M,d as e,w as l,i as r,G as V,j as h,h as q,e as I,H as G,J as Ce}from"./index-DZBIMyl7.js";const Se={class:"role_search"},Ie={class:"role_content"},Ne={class:"role_content_header"},we={__name:"index",setup(Re){const H=ke(),{proxy:N}=Ve(),J=d(null),c=d(null),m=d({pageNum:1,pageSize:10,roleName:void 0,roleKey:void 0,status:void 0}),u=d({roleName:"",roleKey:"",status:"0",menuKeys:[],remark:""}),b=d([]),w=d([]),P=d([]),g=d(!1),x=d(!1),R=d(!0),U=d(!1),K=d(!1),C=d(!0),z=d([]),A=d(!0),T=d([]),Q=he({type:"checkbox",showCheckedAll:!0,onlyCurrent:!1}),W=()=>{},X=()=>{N.$refs.formRef.resetFields(),b.value=[]},B=()=>{u.value={roleId:void 0,roleName:void 0,roleKey:void 0,roleSort:0,status:"0",menuIds:[],deptIds:[],menuCheckStrictly:!0,deptCheckStrictly:!0,remark:void 0},N.$refs.modalFormRef.resetFields()},Z=()=>{B(),c.value.checkAll(!1),x.value=!0,R.value=!0,I("/system/menu/treeselect").then(o=>{w.value=o.data,z.value=[]})},E=o=>{const t=o.roleId||T.value;G.confirm({title:"系统提示",content:`是否确认删除角色编号为${t}的数据项?`,titleAlign:"start",onOk:()=>{}})},ee=async()=>new Promise((o,t)=>{N.$refs.modalFormRef.validate((i,s)=>{i?o(!1):u.value.roleId!=null})});function le(o){return new Promise((t,i)=>{I("/system/menu/roleMenuTreeselect/"+o).then(s=>{w.value=s.menus,t(s)})})}const te=o=>{B(),c.value.checkAll(!1),R.value=!1;const t=o.roleId||ids.value,i=le(t);I("/system/role/detail/"+t).then(s=>{u.value=s.data,u.value.roleSort=Number(u.value.roleSort),x.value=!0,i.then(S=>{S.checkedKeys.forEach(D=>{c.value.checkNode(D,!0,!0)})})})},ae=o=>{U.value=o,o?c.value.expandAll(!0):c.value.expandAll(!1)},oe=o=>{K.value=o,o?c.value.checkAll(!0):c.value.checkAll(!1)},ne=o=>{C.value=o},ue=o=>{T.value=o,o.length>0?A.value=!1:A.value=!0},se=o=>{let t=o.status==="0"?"启用":"停用";G.confirm({title:"系统提示",content:'确认要"'+t+'""'+o.roleName+'"角色吗?',titleAlign:"start",onOk:()=>{},onCancel:()=>{o.status=o.status==="0"?"1":"0"}})},de=o=>{H.push("/system/role-auth/user/"+o.roleId)},L=()=>{g.value=!0,I("/system/role/list",Ce(m.value,b.value)).then(o=>{P.value=o.rows,g.value=!1}).catch(o=>{g.value=!1})};return be(()=>{L()}),(o,t)=>{const i=n("a-input"),s=n("a-form-item"),S=n("a-option"),Y=n("a-select"),D=n("a-range-picker"),f=n("a-button"),v=n("a-space"),j=n("a-form"),F=n("Icon"),re=n("a-tooltip"),_=n("a-table-column"),ie=n("a-switch"),ce=n("a-table"),me=n("a-input-number"),O=n("a-radio"),fe=n("a-radio-group"),$=n("a-checkbox"),_e=n("a-tree"),ve=n("a-textarea"),pe=n("a-modal"),y=ge("hasPermi");return p(),xe("div",null,[M("div",Se,[e(v,null,{default:l(()=>[e(j,{ref_key:"formRef",ref:J,model:m.value,layout:"inline",onSubmit:W},{default:l(()=>[e(s,{field:"roleName",label:"角色名称"},{default:l(()=>[e(i,{modelValue:m.value.roleName,"onUpdate:modelValue":t[0]||(t[0]=a=>m.value.roleName=a)},null,8,["modelValue"])]),_:1}),e(s,{field:"roleKey",label:"权限字符"},{default:l(()=>[e(i,{modelValue:m.value.roleKey,"onUpdate:modelValue":t[1]||(t[1]=a=>m.value.roleKey=a)},null,8,["modelValue"])]),_:1}),e(s,{field:"status",label:"状态"},{default:l(()=>[e(Y,{modelValue:m.value.status,"onUpdate:modelValue":t[2]||(t[2]=a=>m.value.status=a),style:{width:"180px"},"allow-clear":""},{default:l(()=>[e(S,{value:"0",label:"正常"}),e(S,{value:"1",label:"停用"})]),_:1},8,["modelValue"])]),_:1}),e(s,{label:"创建时间"},{default:l(()=>[e(D,{modelValue:b.value,"onUpdate:modelValue":t[3]||(t[3]=a=>b.value=a),style:{width:"254px"},"time-picker-props":{},format:"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),e(s,null,{default:l(()=>[e(v,null,{default:l(()=>[e(f,{type:"primary","html-type":"search"},{default:l(()=>[r("搜索")]),_:1}),e(f,{type:"outline",onClick:X},{default:l(()=>[r("重置")]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),M("div",Ie,[M("div",Ne,[e(v,null,{default:l(()=>[V((p(),h(f,{type:"primary",onClick:Z},{icon:l(()=>[e(F,{icon:"plus"})]),default:l(()=>[r("新增")]),_:1})),[[y,["system:role:add"]]]),V((p(),h(f,{type:"primary",status:"danger",disabled:A.value,onClick:E},{icon:l(()=>[e(F,{icon:"delete"})]),default:l(()=>[r("删除")]),_:1},8,["disabled"])),[[y,["system:role:remove"]]])]),_:1}),e(v,null,{default:l(()=>[e(re,{content:"刷新"},{default:l(()=>[e(f,{shape:"circle",onClick:L},{icon:l(()=>[e(F,{icon:"refresh"})]),_:1})]),_:1})]),_:1})]),e(ce,{ref:"tableRef",class:"role_table",bordered:!1,"row-key":"roleId",loading:g.value,"row-selection":Q,data:P.value,onSelect:ue},{columns:l(()=>[e(_,{title:"角色编号",width:120,"data-index":"roleId",align:"center",sortable:{sortDirections:["ascend","descend"]}}),e(_,{title:"角色名称","data-index":"roleName",align:"center",sortable:{sortDirections:["ascend","descend"]}}),e(_,{title:"权限字符","data-index":"roleKey",align:"center"}),e(_,{title:"显示顺序","data-index":"roleSort",align:"center"}),e(_,{title:"状态","data-index":"status",align:"center"},{cell:l(({record:a})=>[e(ie,{modelValue:a.status,"onUpdate:modelValue":k=>a.status=k,"checked-value":"0","unchecked-value":"1",onChange:k=>se(a)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(_,{title:"创建时间","data-index":"createTime",align:"center"}),e(_,{title:"操作",align:"center"},{cell:l(({record:a})=>[a.roleId!="1"?V((p(),h(f,{key:0,type:"text",size:"mini",onClick:k=>te(a)},{default:l(()=>[r("修改")]),_:2},1032,["onClick"])),[[y,["system:role:edit"]]]):q("",!0),a.roleId!="1"?V((p(),h(f,{key:1,type:"text",size:"mini",status:"danger",onClick:k=>E(a)},{default:l(()=>[r("删除")]),_:2},1032,["onClick"])),[[y,["system:role:remove"]]]):q("",!0),a.roleId!="1"?V((p(),h(f,{key:2,type:"text",size:"mini",onClick:k=>de(a)},{default:l(()=>[r("分配用户")]),_:2},1032,["onClick"])),[[y,["system:role:edit"]]]):q("",!0)]),_:1})]),_:1},8,["loading","row-selection","data"])]),e(pe,{visible:x.value,"onUpdate:visible":t[13]||(t[13]=a=>x.value=a),title:`${R.value?"新增":"修改"}角色`,"on-before-ok":ee},{default:l(()=>[e(j,{ref:"modalFormRef",model:u.value,"auto-label-width":!0},{default:l(()=>[e(s,{field:"roleName",label:"角色名称",rules:[{required:!0,message:"角色名称不能为空"}]},{default:l(()=>[e(i,{modelValue:u.value.roleName,"onUpdate:modelValue":t[4]||(t[4]=a=>u.value.roleName=a)},null,8,["modelValue"])]),_:1}),e(s,{required:"",field:"roleKey",label:"权限字符",tooltip:"控制器中定义的权限字符，如：@PreAuthorize(`@ss.hasRole('admin')`)",rules:[{required:!0,message:"权限字符不能为空"}]},{default:l(()=>[e(i,{modelValue:u.value.roleKey,"onUpdate:modelValue":t[5]||(t[5]=a=>u.value.roleKey=a)},null,8,["modelValue"])]),_:1}),e(s,{field:"roleSort",label:"角色顺序",rules:[{required:!0,message:"角色顺序不能为空"}]},{default:l(()=>[e(me,{modelValue:u.value.roleSort,"onUpdate:modelValue":t[6]||(t[6]=a=>u.value.roleSort=a)},null,8,["modelValue"])]),_:1}),e(s,{field:"status",label:"状态"},{default:l(()=>[e(v,null,{default:l(()=>[e(fe,{modelValue:u.value.status,"onUpdate:modelValue":t[7]||(t[7]=a=>u.value.status=a)},{default:l(()=>[e(O,{value:"0"},{default:l(()=>[r("正常")]),_:1}),e(O,{value:"1"},{default:l(()=>[r("停用")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(s,{field:"menuKeys",label:"菜单权限",class:"menus_item_class"},{default:l(()=>[e(v,null,{default:l(()=>[e($,{modelValue:U.value,"onUpdate:modelValue":t[8]||(t[8]=a=>U.value=a),onChange:ae},{default:l(()=>[r("展开/折叠")]),_:1},8,["modelValue"]),e($,{modelValue:K.value,"onUpdate:modelValue":t[9]||(t[9]=a=>K.value=a),onChange:oe},{default:l(()=>[r("全选/全不选")]),_:1},8,["modelValue"]),e($,{modelValue:C.value,"onUpdate:modelValue":t[10]||(t[10]=a=>C.value=a),onChange:ne},{default:l(()=>[r("父子关联")]),_:1},8,["modelValue"])]),_:1}),e(_e,{ref_key:"treeRef",ref:c,modelValue:u.value.menuKeys,"onUpdate:modelValue":t[11]||(t[11]=a=>u.value.menuKeys=a),class:"menus_tree",checkable:!0,"field-names":{title:"label",key:"id"},"check-strictly":!C.value,"default-expanded-keys":z.value,data:w.value},null,8,["modelValue","check-strictly","default-expanded-keys","data"])]),_:1}),e(s,{field:"remark",label:"备注"},{default:l(()=>[e(ve,{modelValue:u.value.remark,"onUpdate:modelValue":t[12]||(t[12]=a=>u.value.remark=a)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title"])])}}},Ke=ye(we,[["__scopeId","data-v-c4db028c"]]);export{Ke as default};
